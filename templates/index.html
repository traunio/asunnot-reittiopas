{% extends "layout.html" %}
{% block body %}
      <dl>
        <dt>Address of new flat:
        <dd><input type=text name=asunto id="asunto">
        <dt>Find connections to following location:
        <dd><input type="text" name=poi id="poi">
        <dd><input type="button" id="button" value="Give connections">
      </dl>
      <input type=text list=browsers >
      <datalist id=browsers >
	<option> Google
	<option> IE9
      </datalist>
      <canvas id="myChart" height="200"></canvas>
      <script>
       $("#myChart").hide();
       $(document).ready(function() {

	   var ctx = document.getElementById("myChart");
	   var myChart = new Chart(ctx, {
	       type: 'bar',
	       data: {},
	       options: {
		   scales: {
		       xAxes: [{
			   stacked: true,
			   scaleLabel: {
			       display: true,
			       labelString: 'Time of day'}
		       }],
		       yAxes: [{
			   stacked: true,
			   ticks: { beginAtZero:true   },
			   scaleLabel: {
			       display: true,
			       labelString: 'Number of departures' }
		       }]
		   }
	       }
	   });

	   $("#button").click(function (){
	       $.post("/data", {
		   asunto: $("#asunto").val(),
		   poi: $("#poi").val()
	       }, function(data) {
		   if (data.error) {
		       $("#myChart").hide();
		       alert(data.error);
		   } 
		   else {		       		   
		       $("#myChart").show();
		   
		       myChart.data.datasets = data.datasets;
		       myChart.data.labels = data.labels;
		       myChart.update();
		   }    
	       });
	   });
       });

      </script>



    {% endblock %}
